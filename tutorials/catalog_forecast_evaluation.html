

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Catalog-based Forecast Evaluation &mdash; pyCSEP v0.7.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=05c9169f"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plot customizations" href="plot_customizations.html" />
    <link rel="prev" title="Working with catalog-based forecasts" href="working_with_catalog_forecasts.html" />
    <!-- Google Analytics -->
    <!-- added options to anonymize ip and disable cookies using {'storage': 'none'} 
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-495056-15', 'auto', {'storage': 'none'});
    ga('set', 'anonymizeIp', true);
    ga('send', 'pageview');
    </script> -->

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            pyCSEP
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installing.html">Installing pyCSEP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/core_concepts.html">Core Concepts for Beginners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/theory.html">Theory of CSEP Tests</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials and Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="catalog_filtering.html">Catalogs operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_gridded_forecast.html">Plotting gridded forecast</a></li>
<li class="toctree-l1"><a class="reference internal" href="gridded_forecast_evaluation.html">Grid-based Forecast Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quadtree_gridded_forecast_evaluation.html">Quadtree Grid-based Forecast Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_catalog_forecasts.html">Working with catalog-based forecasts</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Catalog-based Forecast Evaluation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#load-required-libraries">Load required libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="#define-start-and-end-times-of-forecast">Define start and end times of forecast</a></li>
<li class="toctree-l2"><a class="reference internal" href="#define-spatial-and-magnitude-regions">Define spatial and magnitude regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#load-catalog-forecast">Load catalog forecast</a></li>
<li class="toctree-l2"><a class="reference internal" href="#obtain-evaluation-catalog-from-comcat">Obtain evaluation catalog from ComCat</a></li>
<li class="toctree-l2"><a class="reference internal" href="#perform-number-test">Perform number test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plot-number-test-result">Plot number test result</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plot_customizations.html">Plot customizations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/catalogs.html">Catalogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/forecasts.html">Forecasts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/evaluations.html">Evaluations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/regions.html">Regions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Help &amp; Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/glossary.html">Terms and Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/publications.html">Referenced Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/roadmap.html">Development Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/developer_notes.html">Developer Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/api_reference.html">API Reference</a></li>
</ul>


    
        <p class="caption">
            <span class="caption-text">Source code and contributing</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://github.com/SCECCode/pycsep/issues">Getting help</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/SCECcode/pycsep/blob/master/CHANGELOG.md">Change log</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/SCECcode/pycsep/blob/master/CONTRIBUTING.md">Contributing</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/SCECcode/pycsep/blob/master/CODE_OF_CONDUCT.md">Code of Conduct</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/SCECcode/pycsep/blob/master/LICENSE">License</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/SCECCode/pycsep">Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyCSEP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Catalog-based Forecast Evaluation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/catalog_forecast_evaluation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorials-catalog-forecast-evaluation-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="catalog-based-forecast-evaluation">
<span id="catalog-forecast-evaluation"></span><span id="sphx-glr-tutorials-catalog-forecast-evaluation-py"></span><h1>Catalog-based Forecast Evaluation<a class="headerlink" href="#catalog-based-forecast-evaluation" title="Link to this heading"></a></h1>
<p>This example shows how to evaluate a catalog-based forecasting using the Number test. This test is the simplest of the
evaluations.</p>
<dl class="simple">
<dt>Overview:</dt><dd><ol class="arabic simple">
<li><p>Define forecast properties (time horizon, spatial region, etc).</p></li>
<li><p>Access catalog from ComCat</p></li>
<li><p>Filter catalog to be consistent with the forecast properties</p></li>
<li><p>Apply catalog-based number test to catalog</p></li>
<li><p>Visualize results for catalog-based forecast</p></li>
</ol>
</dd>
</dl>
<section id="load-required-libraries">
<h2>Load required libraries<a class="headerlink" href="#load-required-libraries" title="Link to this heading"></a></h2>
<p>Most of the core functionality can be imported from the top-level <a class="reference internal" href="../reference/api_reference.html#module-csep" title="csep"><code class="xref py py-mod docutils literal notranslate"><span class="pre">csep</span></code></a> package. Utilities are available from the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">csep.utils</span></code> subpackage.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">csep</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">csep.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">regions</span><span class="p">,</span> <span class="n">catalog_evaluations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">csep.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">time_utils</span>
</pre></div>
</div>
</section>
<section id="define-start-and-end-times-of-forecast">
<h2>Define start and end times of forecast<a class="headerlink" href="#define-start-and-end-times-of-forecast" title="Link to this heading"></a></h2>
<p>Forecasts should define a time horizon in which they are valid. The choice is flexible for catalog-based forecasts, because
the catalogs can be filtered to accommodate multiple end-times. Conceptually, these should be separate forecasts.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="datetime.datetime" class="sphx-glr-backref-module-datetime sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">start_time</span></a> <span class="o">=</span> <a href="../reference/generated/csep.utils.time_utils.strptime_to_utc_datetime.html#csep.utils.time_utils.strptime_to_utc_datetime" title="csep.utils.time_utils.strptime_to_utc_datetime" class="sphx-glr-backref-module-csep-utils-time_utils sphx-glr-backref-type-py-function"><span class="n">time_utils</span><span class="o">.</span><span class="n">strptime_to_utc_datetime</span></a><span class="p">(</span><span class="s2">&quot;1992-06-28 11:57:35.0&quot;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="datetime.datetime" class="sphx-glr-backref-module-datetime sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">end_time</span></a> <span class="o">=</span> <a href="../reference/generated/csep.utils.time_utils.strptime_to_utc_datetime.html#csep.utils.time_utils.strptime_to_utc_datetime" title="csep.utils.time_utils.strptime_to_utc_datetime" class="sphx-glr-backref-module-csep-utils-time_utils sphx-glr-backref-type-py-function"><span class="n">time_utils</span><span class="o">.</span><span class="n">strptime_to_utc_datetime</span></a><span class="p">(</span><span class="s2">&quot;1992-07-28 11:57:35.0&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="define-spatial-and-magnitude-regions">
<h2>Define spatial and magnitude regions<a class="headerlink" href="#define-spatial-and-magnitude-regions" title="Link to this heading"></a></h2>
<p>Before we can compute the bin-wise rates we need to define a spatial region and a set of magnitude bin edges. The magnitude
bin edges # are the lower bound (inclusive) except for the last bin, which is treated as extending to infinity. We can
bind these # to the forecast object. This can also be done by passing them as keyword arguments
into <a class="reference internal" href="../reference/generated/csep.load_catalog_forecast.html#csep.load_catalog_forecast" title="csep.load_catalog_forecast"><code class="xref py py-func docutils literal notranslate"><span class="pre">csep.load_catalog_forecast()</span></code></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Magnitude bins properties</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">min_mw</span></a> <span class="o">=</span> <span class="mf">4.95</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">max_mw</span></a> <span class="o">=</span> <span class="mf">8.95</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dmw</span></a> <span class="o">=</span> <span class="mf">0.1</span>

<span class="c1"># Create space and magnitude regions. The forecast is already filtered in space and magnitude</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">magnitudes</span></a> <span class="o">=</span> <a href="../reference/generated/csep.core.regions.magnitude_bins.html#csep.core.regions.magnitude_bins" title="csep.core.regions.magnitude_bins" class="sphx-glr-backref-module-csep-core-regions sphx-glr-backref-type-py-function"><span class="n">regions</span><span class="o">.</span><span class="n">magnitude_bins</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">min_mw</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">max_mw</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dmw</span></a><span class="p">)</span>
<a href="../reference/generated/csep.core.regions.CartesianGrid2D.html#csep.core.regions.CartesianGrid2D" title="csep.core.regions.CartesianGrid2D" class="sphx-glr-backref-module-csep-core-regions sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">region</span></a> <span class="o">=</span> <a href="../reference/generated/csep.core.regions.california_relm_region.html#csep.core.regions.california_relm_region" title="csep.core.regions.california_relm_region" class="sphx-glr-backref-module-csep-core-regions sphx-glr-backref-type-py-function"><span class="n">regions</span><span class="o">.</span><span class="n">california_relm_region</span></a><span class="p">()</span>

<span class="c1"># Bind region information to the forecast (this will be used for binning of the catalogs)</span>
<a href="../reference/generated/csep.core.regions.CartesianGrid2D.html#csep.core.regions.CartesianGrid2D" title="csep.core.regions.CartesianGrid2D" class="sphx-glr-backref-module-csep-core-regions sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">space_magnitude_region</span></a> <span class="o">=</span> <a href="../reference/generated/csep.core.regions.create_space_magnitude_region.html#csep.core.regions.create_space_magnitude_region" title="csep.core.regions.create_space_magnitude_region" class="sphx-glr-backref-module-csep-core-regions sphx-glr-backref-type-py-function"><span class="n">regions</span><span class="o">.</span><span class="n">create_space_magnitude_region</span></a><span class="p">(</span><a href="../reference/generated/csep.core.regions.CartesianGrid2D.html#csep.core.regions.CartesianGrid2D" title="csep.core.regions.CartesianGrid2D" class="sphx-glr-backref-module-csep-core-regions sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">region</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">magnitudes</span></a><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="load-catalog-forecast">
<h2>Load catalog forecast<a class="headerlink" href="#load-catalog-forecast" title="Link to this heading"></a></h2>
<p>To reduce the file size of this example, we’ve already filtered the catalogs to the appropriate magnitudes and
spatial locations. The original forecast was computed for 1 year following the start date, so we still need to filter the
catalog in time. We can do this by passing a list of filtering arguments to the forecast or updating the class.</p>
<p>By default, the forecast loads catalogs on-demand, so the filters are applied as the catalog loads. On-demand means that
until we loop over the forecast in some capacity, none of the catalogs are actually loaded.</p>
<p>More fine-grain control and optimizations can be achieved by creating a <a class="reference internal" href="../reference/generated/csep.core.forecasts.CatalogForecast.html#csep.core.forecasts.CatalogForecast" title="csep.core.forecasts.CatalogForecast"><code class="xref py py-class docutils literal notranslate"><span class="pre">csep.core.forecasts.CatalogForecast</span></code></a> directly.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../reference/generated/csep.core.forecasts.CatalogForecast.html#csep.core.forecasts.CatalogForecast" title="csep.core.forecasts.CatalogForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast</span></a> <span class="o">=</span> <a href="../reference/generated/csep.load_catalog_forecast.html#csep.load_catalog_forecast" title="csep.load_catalog_forecast" class="sphx-glr-backref-module-csep sphx-glr-backref-type-py-function"><span class="n">csep</span><span class="o">.</span><span class="n">load_catalog_forecast</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">datasets</span><span class="o">.</span><span class="n">ucerf3_ascii_format_landers_fname</span></a><span class="p">,</span>
                                      <a href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="datetime.datetime" class="sphx-glr-backref-module-datetime sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">start_time</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="datetime.datetime" class="sphx-glr-backref-module-datetime sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">start_time</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="datetime.datetime" class="sphx-glr-backref-module-datetime sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">end_time</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="datetime.datetime" class="sphx-glr-backref-module-datetime sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">end_time</span></a><span class="p">,</span>
                                      <a href="../reference/generated/csep.core.regions.CartesianGrid2D.html#csep.core.regions.CartesianGrid2D" title="csep.core.regions.CartesianGrid2D" class="sphx-glr-backref-module-csep-core-regions sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">region</span></a> <span class="o">=</span> <a href="../reference/generated/csep.core.regions.CartesianGrid2D.html#csep.core.regions.CartesianGrid2D" title="csep.core.regions.CartesianGrid2D" class="sphx-glr-backref-module-csep-core-regions sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">space_magnitude_region</span></a><span class="p">,</span>
                                      <span class="n">apply_filters</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Assign filters to forecast</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast</span><span class="o">.</span><span class="n">filters</span></a> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;origin_time &gt;= </span><span class="si">{</span><a href="../reference/generated/csep.core.forecasts.CatalogForecast.html#csep.core.forecasts.CatalogForecast" title="csep.core.forecasts.CatalogForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast</span></a><span class="o">.</span><span class="n">start_epoch</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;origin_time &lt; </span><span class="si">{</span><a href="../reference/generated/csep.core.forecasts.CatalogForecast.html#csep.core.forecasts.CatalogForecast" title="csep.core.forecasts.CatalogForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast</span></a><span class="o">.</span><span class="n">end_epoch</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="obtain-evaluation-catalog-from-comcat">
<h2>Obtain evaluation catalog from ComCat<a class="headerlink" href="#obtain-evaluation-catalog-from-comcat" title="Link to this heading"></a></h2>
<p>The <a class="reference internal" href="../reference/generated/csep.core.forecasts.CatalogForecast.html#csep.core.forecasts.CatalogForecast" title="csep.core.forecasts.CatalogForecast"><code class="xref py py-class docutils literal notranslate"><span class="pre">csep.core.forecasts.CatalogForecast</span></code></a> provides a method to compute the expected number of events in spatial cells. This
requires a region with magnitude information.</p>
<p>We need to filter the ComCat catalog to be consistent with the forecast. This can be done either through the ComCat API
or using catalog filtering strings. Here we’ll use the ComCat API to make the data access quicker for this example. We
still need to filter the observed catalog in space though.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtain Comcat catalog and filter to region.</span>
<a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">comcat_catalog</span></a> <span class="o">=</span> <a href="../reference/generated/csep.query_comcat.html#csep.query_comcat" title="csep.query_comcat" class="sphx-glr-backref-module-csep sphx-glr-backref-type-py-function"><span class="n">csep</span><span class="o">.</span><span class="n">query_comcat</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="datetime.datetime" class="sphx-glr-backref-module-datetime sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">start_time</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="datetime.datetime" class="sphx-glr-backref-module-datetime sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">end_time</span></a><span class="p">,</span> <span class="n">min_magnitude</span><span class="o">=</span><a href="../reference/generated/csep.core.forecasts.CatalogForecast.min_magnitude.html#csep.core.forecasts.CatalogForecast.min_magnitude" title="csep.core.forecasts.CatalogForecast.min_magnitude" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-property"><span class="n">forecast</span><span class="o">.</span><span class="n">min_magnitude</span></a><span class="p">)</span>

<span class="c1"># Filter observed catalog using the same region as the forecast</span>
<a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">comcat_catalog</span></a> <span class="o">=</span> <a href="../reference/generated/csep.core.catalogs.CSEPCatalog.filter_spatial.html#csep.core.catalogs.CSEPCatalog.filter_spatial" title="csep.core.catalogs.CSEPCatalog.filter_spatial" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-method"><span class="n">comcat_catalog</span><span class="o">.</span><span class="n">filter_spatial</span></a><span class="p">(</span><a href="../reference/generated/csep.core.regions.CartesianGrid2D.html#csep.core.regions.CartesianGrid2D" title="csep.core.regions.CartesianGrid2D" class="sphx-glr-backref-module-csep-core-regions sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast</span><span class="o">.</span><span class="n">region</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">comcat_catalog</span></a><span class="p">)</span>

<span class="c1"># Plot the catalog</span>
<a href="../reference/generated/csep.core.catalogs.CSEPCatalog.plot.html#csep.core.catalogs.CSEPCatalog.plot" title="csep.core.catalogs.CSEPCatalog.plot" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-method"><span class="n">comcat_catalog</span><span class="o">.</span><span class="n">plot</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_catalog_forecast_evaluation_001.png" srcset="../_images/sphx_glr_catalog_forecast_evaluation_001.png" alt="catalog forecast evaluation" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Fetched ComCat catalog in 0.2949998378753662 seconds.

Downloaded catalog from ComCat with following parameters
Start Date: 1992-06-28 12:00:45+00:00
End Date: 1992-07-24 18:14:36.250000+00:00
Min Latitude: 33.901 and Max Latitude: 36.705
Min Longitude: -118.067 and Max Longitude: -116.285
Min Magnitude: 4.95
Found 19 events in the ComCat catalog.

        Name: None

        Start Date: 1992-06-28 12:00:45+00:00
        End Date: 1992-07-24 18:14:36.250000+00:00

        Latitude: (33.901, 36.705)
        Longitude: (-118.067, -116.285)

        Min Mw: 4.95
        Max Mw: 6.3

        Event Count: 19


&lt;GeoAxes: &gt;
</pre></div>
</div>
</section>
<section id="perform-number-test">
<h2>Perform number test<a class="headerlink" href="#perform-number-test" title="Link to this heading"></a></h2>
<p>We can perform the Number test on the catalog based forecast using the observed catalog we obtained from Comcat.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">number_test_result</span> <span class="o">=</span> <a href="../reference/generated/csep.core.catalog_evaluations.number_test.html#csep.core.catalog_evaluations.number_test" title="csep.core.catalog_evaluations.number_test" class="sphx-glr-backref-module-csep-core-catalog_evaluations sphx-glr-backref-type-py-function"><span class="n">catalog_evaluations</span><span class="o">.</span><span class="n">number_test</span></a><span class="p">(</span><a href="../reference/generated/csep.core.forecasts.CatalogForecast.html#csep.core.forecasts.CatalogForecast" title="csep.core.forecasts.CatalogForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast</span></a><span class="p">,</span> <a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">comcat_catalog</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Processed 1 catalogs in 0.0012803077697753906 seconds
Processed 2 catalogs in 0.0017325878143310547 seconds
Processed 3 catalogs in 0.002131938934326172 seconds
Processed 4 catalogs in 0.002412080764770508 seconds
Processed 5 catalogs in 0.0026826858520507812 seconds
Processed 6 catalogs in 0.003053426742553711 seconds
Processed 7 catalogs in 0.003324747085571289 seconds
Processed 8 catalogs in 0.003731966018676758 seconds
Processed 9 catalogs in 0.00468134880065918 seconds
Processed 10 catalogs in 0.0050411224365234375 seconds
Processed 20 catalogs in 0.008867502212524414 seconds
Processed 30 catalogs in 0.01295614242553711 seconds
Processed 40 catalogs in 0.016607999801635742 seconds
Processed 50 catalogs in 0.02075505256652832 seconds
Processed 60 catalogs in 0.02426934242248535 seconds
Processed 70 catalogs in 0.02760791778564453 seconds
Processed 80 catalogs in 0.03125190734863281 seconds
Processed 90 catalogs in 0.03504371643066406 seconds
Processed 100 catalogs in 0.03836703300476074 seconds
Processed 200 catalogs in 0.07099199295043945 seconds
Processed 300 catalogs in 0.10698151588439941 seconds
Processed 400 catalogs in 0.14195680618286133 seconds
Processed 500 catalogs in 0.2055041790008545 seconds
Processed 600 catalogs in 0.24000763893127441 seconds
Processed 700 catalogs in 0.2749521732330322 seconds
Processed 800 catalogs in 0.34209680557250977 seconds
Processed 900 catalogs in 0.37566685676574707 seconds
Processed 1000 catalogs in 0.41100311279296875 seconds
Processed 2000 catalogs in 0.9079108238220215 seconds
Processed 3000 catalogs in 1.3686177730560303 seconds
Processed 4000 catalogs in 1.8394980430603027 seconds
Processed 5000 catalogs in 2.302907705307007 seconds
Processed 6000 catalogs in 2.765509843826294 seconds
Processed 7000 catalogs in 3.249851703643799 seconds
Processed 8000 catalogs in 3.678293466567993 seconds
Processed 9000 catalogs in 4.190564870834351 seconds
Processed 10000 catalogs in 4.6541008949279785 seconds
</pre></div>
</div>
</section>
<section id="plot-number-test-result">
<h2>Plot number test result<a class="headerlink" href="#plot-number-test-result" title="Link to this heading"></a></h2>
<p>We can create a simple visualization of the number test from the evaluation result class.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <span class="n">number_test_result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_catalog_forecast_evaluation_002.png" srcset="../_images/sphx_glr_catalog_forecast_evaluation_002.png" alt="Number Test" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 9.381 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorials-catalog-forecast-evaluation-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/51fa1488df4465555cbdd7b8b69e1267/catalog_forecast_evaluation.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">catalog_forecast_evaluation.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/2515b7400434bdc3a7f98dcd18d5029f/catalog_forecast_evaluation.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">catalog_forecast_evaluation.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/cdfcae4b5aede20f8604490d6c58c61f/catalog_forecast_evaluation.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">catalog_forecast_evaluation.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="working_with_catalog_forecasts.html" class="btn btn-neutral float-left" title="Working with catalog-based forecasts" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plot_customizations.html" class="btn btn-neutral float-right" title="Plot customizations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  
 
&#169; 2020, University of Southern California.
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>