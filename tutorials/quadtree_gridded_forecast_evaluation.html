

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quadtree Grid-based Forecast Evaluation &mdash; pyCSEP v0.7.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=05c9169f"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with catalog-based forecasts" href="working_with_catalog_forecasts.html" />
    <link rel="prev" title="Grid-based Forecast Evaluation" href="gridded_forecast_evaluation.html" />
    <!-- Google Analytics -->
    <!-- added options to anonymize ip and disable cookies using {'storage': 'none'} 
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-495056-15', 'auto', {'storage': 'none'});
    ga('set', 'anonymizeIp', true);
    ga('send', 'pageview');
    </script> -->

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            pyCSEP
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installing.html">Installing pyCSEP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/core_concepts.html">Core Concepts for Beginners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/theory.html">Theory of CSEP Tests</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials and Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="catalog_filtering.html">Catalogs operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_gridded_forecast.html">Plotting gridded forecast</a></li>
<li class="toctree-l1"><a class="reference internal" href="gridded_forecast_evaluation.html">Grid-based Forecast Evaluation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quadtree Grid-based Forecast Evaluation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#load-required-libraries">Load required libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="#load-training-catalog-for-multi-resolution-grid">Load Training Catalog for Multi-resolution grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="#define-multi-resolution-gridded-region">Define Multi-resolution Gridded Region</a></li>
<li class="toctree-l2"><a class="reference internal" href="#define-single-resolution-gridded-region">Define Single-resolution Gridded Region</a></li>
<li class="toctree-l2"><a class="reference internal" href="#load-forecast-of-multi-resolution-grid">Load forecast of multi-resolution grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="#load-forecast-of-single-resolution-grid">Load forecast of single-resolution grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="#load-evaluation-catalog">Load evaluation catalog</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compute-poisson-spatial-test-and-number-test">Compute Poisson spatial test and Number test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plot-spatial-test-results">Plot spatial test results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="working_with_catalog_forecasts.html">Working with catalog-based forecasts</a></li>
<li class="toctree-l1"><a class="reference internal" href="catalog_forecast_evaluation.html">Catalog-based Forecast Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_customizations.html">Plot customizations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/catalogs.html">Catalogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/forecasts.html">Forecasts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/evaluations.html">Evaluations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/regions.html">Regions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Help &amp; Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/glossary.html">Terms and Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/publications.html">Referenced Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/roadmap.html">Development Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/developer_notes.html">Developer Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/api_reference.html">API Reference</a></li>
</ul>


    
        <p class="caption">
            <span class="caption-text">Source code and contributing</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://github.com/SCECCode/pycsep/issues">Getting help</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/SCECcode/pycsep/blob/master/CHANGELOG.md">Change log</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/SCECcode/pycsep/blob/master/CONTRIBUTING.md">Contributing</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/SCECcode/pycsep/blob/master/CODE_OF_CONDUCT.md">Code of Conduct</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/SCECcode/pycsep/blob/master/LICENSE">License</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/SCECCode/pycsep">Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyCSEP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Quadtree Grid-based Forecast Evaluation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/quadtree_gridded_forecast_evaluation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorials-quadtree-gridded-forecast-evaluation-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="quadtree-grid-based-forecast-evaluation">
<span id="quadtree-gridded-forecast-evaluation"></span><span id="sphx-glr-tutorials-quadtree-gridded-forecast-evaluation-py"></span><h1>Quadtree Grid-based Forecast Evaluation<a class="headerlink" href="#quadtree-grid-based-forecast-evaluation" title="Link to this heading">ÔÉÅ</a></h1>
<p>This example demonstrates how to create a quadtree based single resolution-grid and multi-resolution grid.
Multi-resolution grid is created using earthquake catalog, in which seismic density determines the size of a grid cell.
In creating a multi-resolution grid we select a threshold (<span class="math notranslate nohighlight">\(N_{max}\)</span>) as a maximum number of earthquake in each cell.
In single-resolution grid, we simply select a zoom-level (L) that determines a single resolution grid.
The number of cells in single-resolution grid are equal to <span class="math notranslate nohighlight">\(4^L\)</span>. The zoom-level L=11 leads to 4.2 million cells, nearest to 0.1x0.1 grid.</p>
<p>We use these grids to create and evaluate a time-independent forecast. Grid-based
forecasts assume the variability of the forecasts is Poissonian. Therefore, poisson-based evaluations
should be used to evaluate grid-based forecasts defined using quadtree regions.</p>
<dl class="simple">
<dt>Overview:</dt><dd><ol class="arabic simple">
<li><dl class="simple">
<dt>Define spatial grids</dt><dd><ul class="simple">
<li><p>Multi-resolution grid</p></li>
<li><p>Single-resolution grid</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Load forecasts</dt><dd><ul class="simple">
<li><p>Multi-resolution forecast</p></li>
<li><p>Single-resolution forecast</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Load evaluation catalog</p></li>
<li><p>Apply Poissonian evaluations for both grid-based forecasts</p></li>
<li><p>Visualize evaluation results</p></li>
</ol>
</dd>
</dl>
<section id="load-required-libraries">
<h2>Load required libraries<a class="headerlink" href="#load-required-libraries" title="Link to this heading">ÔÉÅ</a></h2>
<p>Most of the core functionality can be imported from the top-level <a class="reference internal" href="../reference/api_reference.html#module-csep" title="csep"><code class="xref py py-mod docutils literal notranslate"><span class="pre">csep</span></code></a> package. Utilities are available from the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">csep.utils</span></code> subpackage.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">csep.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">poisson_evaluations</span> <span class="k">as</span> <span class="n">poisson</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">csep.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">time_utils</span><span class="p">,</span> <span class="n">plots</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">csep.core.regions</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuadtreeGrid2D</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">csep.core.forecasts</span><span class="w"> </span><span class="kn">import</span> <a href="../reference/generated/csep.core.forecasts.GriddedForecast.html#csep.core.forecasts.GriddedForecast" title="csep.core.forecasts.GriddedForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class"><span class="n">GriddedForecast</span></a>
<span class="kn">from</span><span class="w"> </span><span class="nn">csep.utils.time_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">decimal_year_to_utc_epoch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">csep.core.catalogs</span><span class="w"> </span><span class="kn">import</span> <span class="n">CSEPCatalog</span>
</pre></div>
</div>
</section>
<section id="load-training-catalog-for-multi-resolution-grid">
<h2>Load Training Catalog for Multi-resolution grid<a class="headerlink" href="#load-training-catalog-for-multi-resolution-grid" title="Link to this heading">ÔÉÅ</a></h2>
<p>We define a multi-resolution quadtree using earthquake catalog. We load a training catalog in CSEP and use that catalog to create a multi-resolution grid.
Sometimes, we do not the catalog in exact format as requried by pyCSEP. So we can read a catalog using Pandas and convert it
into the format accepable by PyCSEP. Then we instantiate an object of class CSEPCatalog by calling function <code class="xref py py-func docutils literal notranslate"><span class="pre">csep.core.regions.CSEPCatalog.from_dataframe()</span></code></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.core.frame.DataFrame" class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dfcat</span></a> <span class="o">=</span> <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html#pandas.read_csv" title="pandas.read_csv" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-function"><span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span></a><span class="p">(</span><span class="s1">&#39;cat_train_2013.csv&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">column_name_mapper</span></a> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mag&#39;</span><span class="p">:</span> <span class="s1">&#39;magnitude&#39;</span><span class="p">,</span>
    <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;id&#39;</span>
    <span class="p">}</span>

<span class="c1"># maps the column names to the dtype expected by the catalog class</span>
<a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.core.frame.DataFrame" class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dfcat</span></a> <span class="o">=</span> <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.reset_index.html#pandas.DataFrame.reset_index" title="pandas.DataFrame.reset_index" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-method"><span class="n">dfcat</span><span class="o">.</span><span class="n">reset_index</span></a><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">column_name_mapper</span></a><span class="p">)</span>

<span class="c1"># create the origin_times from decimal years</span>
<a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.core.frame.DataFrame" class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dfcat</span></a><span class="p">[</span><span class="s1">&#39;origin_time&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html#pandas.DataFrame.apply" title="pandas.DataFrame.apply" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-method"><span class="n">dfcat</span><span class="o">.</span><span class="n">apply</span></a><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">decimal_year_to_utc_epoch</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">year</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># create catalog from dataframe</span>
<a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">catalog_train</span></a> <span class="o">=</span> <a href="../reference/generated/csep.core.catalogs.CSEPCatalog.from_dataframe.html#csep.core.catalogs.CSEPCatalog.from_dataframe" title="csep.core.catalogs.CSEPCatalog.from_dataframe" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-method"><span class="n">CSEPCatalog</span><span class="o">.</span><span class="n">from_dataframe</span></a><span class="p">(</span><a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.core.frame.DataFrame" class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dfcat</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">catalog_train</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Name: None

Start Date: 1976-01-01 00:00:00+00:00
End Date: 2013-01-01 00:00:00+00:00

Latitude: (-77.16000366, 87.01999664)
Longitude: (-180.0, 180.0)

Min Mw: 5.150024414
Max Mw: 9.08350563

Event Count: 28465
</pre></div>
</div>
</section>
<section id="define-multi-resolution-gridded-region">
<h2>Define Multi-resolution Gridded Region<a class="headerlink" href="#define-multi-resolution-gridded-region" title="Link to this heading">ÔÉÅ</a></h2>
<p>Now use define a threshold for maximum number of earthquake allowed per cell, i.e. Nmax
and call <code class="xref py py-func docutils literal notranslate"><span class="pre">csep.core.regions.QuadtreeGrid_from_catalog()</span></code> to create a multi-resolution grid.
For simplicity we assume only single magnitude bin, i.e. all the earthquakes greater than and equal to 5.95</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mbins</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">numpy</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mf">5.95</span><span class="p">])</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nmax</span></a> <span class="o">=</span> <span class="mi">25</span>
<span class="n">r_multi</span> <span class="o">=</span> <span class="n">QuadtreeGrid2D</span><span class="o">.</span><span class="n">from_catalog</span><span class="p">(</span><a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">catalog_train</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Nmax</span></a><span class="p">,</span> <span class="n">magnitudes</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mbins</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of cells in Multi-resolution grid :&#39;</span><span class="p">,</span> <span class="n">r_multi</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Number of cells in Multi-resolution grid : 3502
</pre></div>
</div>
</section>
<section id="define-single-resolution-gridded-region">
<h2>Define Single-resolution Gridded Region<a class="headerlink" href="#define-single-resolution-gridded-region" title="Link to this heading">ÔÉÅ</a></h2>
<p>Here as an example we define a single resolution grid at zoom-level L=6. For this purpose
we call <code class="xref py py-func docutils literal notranslate"><span class="pre">csep.core.regions.QuadtreeGrid2D_from_single_resolution()</span></code> to create a single resolution grid.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For simplicity of example, we assume only single magnitude bin,</span>
<span class="c1"># i.e. all the earthquakes greater than and equal to 5.95</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mbins</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">numpy</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mf">5.95</span><span class="p">])</span>
<span class="n">r_single</span> <span class="o">=</span> <span class="n">QuadtreeGrid2D</span><span class="o">.</span><span class="n">from_single_resolution</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">magnitudes</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mbins</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of cells in Single-Resolution grid :&#39;</span><span class="p">,</span> <span class="n">r_single</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Number of cells in Single-Resolution grid : 4096
</pre></div>
</div>
</section>
<section id="load-forecast-of-multi-resolution-grid">
<h2>Load forecast of multi-resolution grid<a class="headerlink" href="#load-forecast-of-multi-resolution-grid" title="Link to this heading">ÔÉÅ</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># An example time-independent forecast had been created for this grid and provided the example forecast data set along with the main repository.</span>
<span class="c1"># We load the time-independent global forecast which has time horizon of 1 year.</span>
<span class="c1"># The filepath is relative to the root directory of the package. You can specify any file location for your forecasts.</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_data</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.loadtxt.html#numpy.loadtxt" title="numpy.loadtxt" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">numpy</span><span class="o">.</span><span class="n">loadtxt</span></a><span class="p">(</span><span class="s1">&#39;example_rate_zoom=EQ10L11.csv&#39;</span><span class="p">)</span>
<span class="c1">#Reshape forecast as Nx1 array</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_data</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_data</span></a><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<a href="../reference/generated/csep.core.forecasts.GriddedForecast.html#csep.core.forecasts.GriddedForecast" title="csep.core.forecasts.GriddedForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_multi_grid</span></a> <span class="o">=</span> <a href="../reference/generated/csep.core.forecasts.GriddedForecast.html#csep.core.forecasts.GriddedForecast" title="csep.core.forecasts.GriddedForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class"><span class="n">GriddedForecast</span></a><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_data</span></a><span class="p">,</span> <span class="n">region</span> <span class="o">=</span> <span class="n">r_multi</span><span class="p">,</span> <span class="n">magnitudes</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mbins</span></a><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Example Multi-res Forecast&#39;</span><span class="p">)</span>

<span class="c1">#The loaded forecast is for 1 year. The test catalog we will use to evaluate is for 6 years. So we can rescale the forecast.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected event count before scaling: </span><span class="si">{</span><a href="../reference/generated/csep.core.forecasts.GriddedForecast.event_count.html#csep.core.forecasts.GriddedForecast.event_count" title="csep.core.forecasts.GriddedForecast.event_count" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-property"><span class="n">forecast_multi_grid</span><span class="o">.</span><span class="n">event_count</span></a><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a href="../reference/generated/csep.core.forecasts.GriddedForecast.html#csep.core.forecasts.GriddedForecast" title="csep.core.forecasts.GriddedForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_multi_grid</span></a><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected event count after scaling: </span><span class="si">{</span><a href="../reference/generated/csep.core.forecasts.GriddedForecast.event_count.html#csep.core.forecasts.GriddedForecast.event_count" title="csep.core.forecasts.GriddedForecast.event_count" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-property"><span class="n">forecast_multi_grid</span><span class="o">.</span><span class="n">event_count</span></a><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>expected event count before scaling: 116.18568954606255
expected event count after scaling: 697.1141372763753
</pre></div>
</div>
</section>
<section id="load-forecast-of-single-resolution-grid">
<h2>Load forecast of single-resolution grid<a class="headerlink" href="#load-forecast-of-single-resolution-grid" title="Link to this heading">ÔÉÅ</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># We have already created a time-independent global forecast with time horizon of 1 year and provided with the reporsitory.</span>
<span class="c1"># The filepath is relative to the root directory of the package. You can specify any file location for your forecasts.</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_data</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.loadtxt.html#numpy.loadtxt" title="numpy.loadtxt" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">numpy</span><span class="o">.</span><span class="n">loadtxt</span></a><span class="p">(</span><span class="s1">&#39;example_rate_zoom=6.csv&#39;</span><span class="p">)</span>
<span class="c1">#Reshape forecast as Nx1 array</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_data</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_data</span></a><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<a href="../reference/generated/csep.core.forecasts.GriddedForecast.html#csep.core.forecasts.GriddedForecast" title="csep.core.forecasts.GriddedForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_single_grid</span></a> <span class="o">=</span> <a href="../reference/generated/csep.core.forecasts.GriddedForecast.html#csep.core.forecasts.GriddedForecast" title="csep.core.forecasts.GriddedForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class"><span class="n">GriddedForecast</span></a><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_data</span></a><span class="p">,</span> <span class="n">region</span> <span class="o">=</span> <span class="n">r_single</span><span class="p">,</span>
                                   <span class="n">magnitudes</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mbins</span></a><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Example Single-res Forecast&#39;</span><span class="p">)</span>

<span class="c1"># The loaded forecast is for 1 year. The test catalog we will use is for 6 years. So we can rescale the forecast.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected event count before scaling: </span><span class="si">{</span><a href="../reference/generated/csep.core.forecasts.GriddedForecast.event_count.html#csep.core.forecasts.GriddedForecast.event_count" title="csep.core.forecasts.GriddedForecast.event_count" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-property"><span class="n">forecast_single_grid</span><span class="o">.</span><span class="n">event_count</span></a><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a href="../reference/generated/csep.core.forecasts.GriddedForecast.html#csep.core.forecasts.GriddedForecast" title="csep.core.forecasts.GriddedForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_single_grid</span></a><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected event count after scaling: </span><span class="si">{</span><a href="../reference/generated/csep.core.forecasts.GriddedForecast.event_count.html#csep.core.forecasts.GriddedForecast.event_count" title="csep.core.forecasts.GriddedForecast.event_count" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-property"><span class="n">forecast_single_grid</span><span class="o">.</span><span class="n">event_count</span></a><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>expected event count before scaling: 116.18568954606256
expected event count after scaling: 697.1141372763753
</pre></div>
</div>
</section>
<section id="load-evaluation-catalog">
<h2>Load evaluation catalog<a class="headerlink" href="#load-evaluation-catalog" title="Link to this heading">ÔÉÅ</a></h2>
<p>We have a test catalog stored here. We can read the test catalog as a pandas frame and convert it into a format that is acceptable to PyCSEP
Then we instantiate an object of catalog</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.core.frame.DataFrame" class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dfcat</span></a> <span class="o">=</span> <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html#pandas.read_csv" title="pandas.read_csv" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-function"><span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span></a><span class="p">(</span><span class="s1">&#39;cat_test.csv&#39;</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">column_name_mapper</span></a> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mag&#39;</span><span class="p">:</span> <span class="s1">&#39;magnitude&#39;</span>
    <span class="p">}</span>

<span class="c1"># maps the column names to the dtype expected by the catalog class</span>
<a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.core.frame.DataFrame" class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dfcat</span></a> <span class="o">=</span> <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.reset_index.html#pandas.DataFrame.reset_index" title="pandas.DataFrame.reset_index" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-method"><span class="n">dfcat</span><span class="o">.</span><span class="n">reset_index</span></a><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">column_name_mapper</span></a><span class="p">)</span>
<span class="c1"># create the origin_times from decimal years</span>
<a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.core.frame.DataFrame" class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dfcat</span></a><span class="p">[</span><span class="s1">&#39;origin_time&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html#pandas.DataFrame.apply" title="pandas.DataFrame.apply" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-method"><span class="n">dfcat</span><span class="o">.</span><span class="n">apply</span></a><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">decimal_year_to_utc_epoch</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">year</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># create catalog from dataframe</span>
<a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">catalog</span></a> <span class="o">=</span> <a href="../reference/generated/csep.core.catalogs.CSEPCatalog.from_dataframe.html#csep.core.catalogs.CSEPCatalog.from_dataframe" title="csep.core.catalogs.CSEPCatalog.from_dataframe" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-method"><span class="n">CSEPCatalog</span><span class="o">.</span><span class="n">from_dataframe</span></a><span class="p">(</span><a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.core.frame.DataFrame" class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dfcat</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">catalog</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Name: None

Start Date: 2014-01-01 00:00:00+00:00
End Date: 2019-01-01 00:00:00+00:00

Latitude: (-63.26, 74.39)
Longitude: (-179.23, 179.66)

Min Mw: 5.95047692260089
Max Mw: 8.27271203001144

Event Count: 651
</pre></div>
</div>
</section>
<section id="compute-poisson-spatial-test-and-number-test">
<h2>Compute Poisson spatial test and Number test<a class="headerlink" href="#compute-poisson-spatial-test-and-number-test" title="Link to this heading">ÔÉÅ</a></h2>
<p>Simply call the <a class="reference internal" href="../reference/generated/csep.core.poisson_evaluations.spatial_test.html#csep.core.poisson_evaluations.spatial_test" title="csep.core.poisson_evaluations.spatial_test"><code class="xref py py-func docutils literal notranslate"><span class="pre">csep.core.poisson_evaluations.spatial_test()</span></code></a>  and <a class="reference internal" href="../reference/generated/csep.core.poisson_evaluations.number_test.html#csep.core.poisson_evaluations.number_test" title="csep.core.poisson_evaluations.number_test"><code class="xref py py-func docutils literal notranslate"><span class="pre">csep.core.poisson_evaluations.number_test()</span></code></a> functions to evaluate the forecast using the specified
evaluation catalog. The spatial test requires simulating from the Poisson forecast to provide uncertainty. The verbose
option prints the status of the simulations to the standard output.</p>
<p>Note: But before we use evaluation catalog, we need to link gridded region with observed catalog.
Since we have two different grids here, so we do it separately for both grids.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1">#For Multi-resolution grid, linking region to catalog.</span>
<a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">catalog</span></a><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <a href="../reference/generated/csep.core.forecasts.GriddedForecast.html#csep.core.forecasts.GriddedForecast" title="csep.core.forecasts.GriddedForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_multi_grid</span></a><span class="o">.</span><span class="n">region</span>
<span class="n">spatial_test_multi_res_result</span> <span class="o">=</span> <a href="../reference/generated/csep.core.poisson_evaluations.spatial_test.html#csep.core.poisson_evaluations.spatial_test" title="csep.core.poisson_evaluations.spatial_test" class="sphx-glr-backref-module-csep-core-poisson_evaluations sphx-glr-backref-type-py-function"><span class="n">poisson</span><span class="o">.</span><span class="n">spatial_test</span></a><span class="p">(</span><a href="../reference/generated/csep.core.forecasts.GriddedForecast.html#csep.core.forecasts.GriddedForecast" title="csep.core.forecasts.GriddedForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_multi_grid</span></a><span class="p">,</span> <a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">catalog</span></a><span class="p">)</span>
<span class="n">number_test_multi_res_result</span> <span class="o">=</span> <a href="../reference/generated/csep.core.poisson_evaluations.number_test.html#csep.core.poisson_evaluations.number_test" title="csep.core.poisson_evaluations.number_test" class="sphx-glr-backref-module-csep-core-poisson_evaluations sphx-glr-backref-type-py-function"><span class="n">poisson</span><span class="o">.</span><span class="n">number_test</span></a><span class="p">(</span><a href="../reference/generated/csep.core.forecasts.GriddedForecast.html#csep.core.forecasts.GriddedForecast" title="csep.core.forecasts.GriddedForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_multi_grid</span></a><span class="p">,</span> <a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">catalog</span></a><span class="p">)</span>


<span class="c1">#For Single-resolution grid, linking region to catalog.</span>
<a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">catalog</span></a><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <a href="../reference/generated/csep.core.forecasts.GriddedForecast.html#csep.core.forecasts.GriddedForecast" title="csep.core.forecasts.GriddedForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_single_grid</span></a><span class="o">.</span><span class="n">region</span>
<span class="n">spatial_test_single_res_result</span> <span class="o">=</span> <a href="../reference/generated/csep.core.poisson_evaluations.spatial_test.html#csep.core.poisson_evaluations.spatial_test" title="csep.core.poisson_evaluations.spatial_test" class="sphx-glr-backref-module-csep-core-poisson_evaluations sphx-glr-backref-type-py-function"><span class="n">poisson</span><span class="o">.</span><span class="n">spatial_test</span></a><span class="p">(</span><a href="../reference/generated/csep.core.forecasts.GriddedForecast.html#csep.core.forecasts.GriddedForecast" title="csep.core.forecasts.GriddedForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_single_grid</span></a><span class="p">,</span> <a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">catalog</span></a><span class="p">)</span>
<span class="n">number_test_single_res_result</span> <span class="o">=</span> <a href="../reference/generated/csep.core.poisson_evaluations.number_test.html#csep.core.poisson_evaluations.number_test" title="csep.core.poisson_evaluations.number_test" class="sphx-glr-backref-module-csep-core-poisson_evaluations sphx-glr-backref-type-py-function"><span class="n">poisson</span><span class="o">.</span><span class="n">number_test</span></a><span class="p">(</span><a href="../reference/generated/csep.core.forecasts.GriddedForecast.html#csep.core.forecasts.GriddedForecast" title="csep.core.forecasts.GriddedForecast" class="sphx-glr-backref-module-csep-core-forecasts sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">forecast_single_grid</span></a><span class="p">,</span> <a href="../reference/generated/csep.core.catalogs.CSEPCatalog.html#csep.core.catalogs.CSEPCatalog" title="csep.core.catalogs.CSEPCatalog" class="sphx-glr-backref-module-csep-core-catalogs sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">catalog</span></a><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="plot-spatial-test-results">
<h2>Plot spatial test results<a class="headerlink" href="#plot-spatial-test-results" title="Link to this heading">ÔÉÅ</a></h2>
<p>We provide the function <code class="xref py py-func docutils literal notranslate"><span class="pre">csep.utils.plotting.plot_poisson_consistency_test()</span></code> to visualize the evaluation results from
consistency tests.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stest_result</span></a> <span class="o">=</span> <span class="p">[</span><span class="n">spatial_test_single_res_result</span><span class="p">,</span> <span class="n">spatial_test_multi_res_result</span><span class="p">]</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax_spatial</span></a> <span class="o">=</span> <a href="../reference/generated/csep.utils.plots.plot_poisson_consistency_test.html#csep.utils.plots.plot_poisson_consistency_test" title="csep.utils.plots.plot_poisson_consistency_test" class="sphx-glr-backref-module-csep-utils-plots sphx-glr-backref-type-py-function"><span class="n">plots</span><span class="o">.</span><span class="n">plot_poisson_consistency_test</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stest_result</span></a><span class="p">,</span>
                                        <span class="n">plot_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s1">&#39;Spatial likelihood&#39;</span><span class="p">})</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ntest_result</span></a> <span class="o">=</span> <span class="p">[</span><span class="n">number_test_single_res_result</span><span class="p">,</span> <span class="n">number_test_multi_res_result</span><span class="p">]</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax_number</span></a> <span class="o">=</span> <a href="../reference/generated/csep.utils.plots.plot_poisson_consistency_test.html#csep.utils.plots.plot_poisson_consistency_test" title="csep.utils.plots.plot_poisson_consistency_test" class="sphx-glr-backref-module-csep-utils-plots sphx-glr-backref-type-py-function"><span class="n">plots</span><span class="o">.</span><span class="n">plot_poisson_consistency_test</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ntest_result</span></a><span class="p">,</span>
                                        <span class="n">plot_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s1">&#39;Number of Earthquakes&#39;</span><span class="p">})</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_quadtree_gridded_forecast_evaluation_001.png" srcset="../_images/sphx_glr_quadtree_gridded_forecast_evaluation_001.png" alt="Poisson S-Test" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_quadtree_gridded_forecast_evaluation_002.png" srcset="../_images/sphx_glr_quadtree_gridded_forecast_evaluation_002.png" alt="Poisson N-Test" class = "sphx-glr-multi-img"/></li>
</ul>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 1.782 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorials-quadtree-gridded-forecast-evaluation-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/a42d97e40eabca8f50460c166c77590c/quadtree_gridded_forecast_evaluation.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">quadtree_gridded_forecast_evaluation.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/3407447997731565b431a92b17054ced/quadtree_gridded_forecast_evaluation.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">quadtree_gridded_forecast_evaluation.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/89d8257ecc015d8ebf1890ed8afc2929/quadtree_gridded_forecast_evaluation.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">quadtree_gridded_forecast_evaluation.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gridded_forecast_evaluation.html" class="btn btn-neutral float-left" title="Grid-based Forecast Evaluation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="working_with_catalog_forecasts.html" class="btn btn-neutral float-right" title="Working with catalog-based forecasts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  
 
&#169; 2020, University of Southern California.
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>